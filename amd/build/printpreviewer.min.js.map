{"version":3,"file":"printpreviewer.min.js","sources":["../src/printpreviewer.js"],"sourcesContent":["// This file is part of mod_grouptool for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS handling of the printpreview form\n *\n * @module    local_assignsubmission_download/printpreviewer\n * @author    Andreas Krieger\n * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module local_assignsubmission_download/printpreviewer\n */\ndefine(['jquery', 'core/log'], function($, log) {\n    /**\n     * @contructor\n     * @alias module:local_assignsubmission_download/printpreviewer\n     */\n    var Printpreviewer = function() {\n    };\n\n    Printpreviewer.prototype.change_in_perpage = function(e) {\n        // Stop the event's default behavior.\n        e.preventDefault();\n        // Stop the event from bubbling up the DOM tree.\n        e.stopPropagation();\n\n        if($(window.combo[1]).val() == 0) {\n            // Check checkbox and disable text field.\n            $(window.combo[0]).prop('checked', true);\n            $(window.combo[1]).prop('disabled', true);\n        } else {\n            // Save last value, uncheck checkbox and enable textfield if checked/disabled.\n            window.stdperpage = $(window.combo[1]).val();\n            $(window.combo[0]).prop('checked', false);\n            $(window.combo[1]).prop('disabled', false);\n        }\n    };\n\n    Printpreviewer.prototype.change_in_optimum = function(e) {\n        // Stop the event's default behavior.\n        e.preventDefault();\n        // Stop the event from bubbling up the DOM tree.\n        e.stopPropagation();\n\n        if($(window.combo[0]).prop('checked')) {\n            // Save last value, set to 0 and disable textfield.\n            window.stdperpage = $(window.combo[1]).val();\n            $(window.combo[1]).val(0);\n            $(window.combo[1]).prop('disabled', true);\n        } else {\n            // Restore last value and enable again.\n            $(window.combo[1]).val(window.stdperpage);\n            $(window.combo[1]).prop('disabled', false);\n        }\n    };\n\n    var instance = new Printpreviewer();\n\n    instance.initializer = function() {\n        // Woraround: prevent second loading of javascript code, which happens don't know why (AK).\n        if (window.washere) {return true;}\n        window.washere = 1;\n        log.info('Initialise printpreview handling js...', 'local_assignsubmission_download');\n\n        var filterelement = $('#id_filter');\n        var groupelement  = $('#id_group');\n        var exportformat  = $('#id_exportformat');\n        var selectall = $('#selectall');\n        var select = $('td.cell input[type=checkbox]');\n\n        var toggleprintsettings = function (exportformat) {\n            if (exportformat == 0) {\n                $('#id_grpperpage_perpage').prop('disabled', false);\n                $('#id_grpperpage_optimum').prop('disabled', false);\n                $('#id_textsize').prop('disabled', false);\n                $('#id_pageorientation').prop('disabled', false);\n                $('#id_printheader').prop('disabled', false);\n            } else {\n                $('#id_grpperpage_perpage').prop('disabled', true);\n                $('#id_grpperpage_optimum').prop('disabled', true);\n                $('#id_textsize').prop('disabled', true);\n                $('#id_pageorientation').prop('disabled', true);\n                $('#id_printheader').prop('disabled', true);\n            }\n        };\n\n        if (filterelement) {\n            filterelement.on('change', function() {\n                $('form.mform').submit();\n            });\n        }\n\n        if (groupelement) {\n            groupelement.on('change', function() {\n                $('form.mform').submit();\n            });\n        }\n\n        if (exportformat) {\n            exportformat.on('change', function() {\n                toggleprintsettings(exportformat.val());\n            });\n        }\n\n        selectall.prop('checked', 'checked');\n        select.prop('checked', 'checked');\n\n        window.combo = new Array();\n        window.combo[0] = 'input[id=id_grpperpage_optimum]';\n        window.combo[1] = 'input[id=id_grpperpage_perpage]';\n\n        window.stdperpage = $(window.combo[1]).val();\n\n        if($(window.combo[0]).checked) {\n            $(window.combo[1]).prop('disabled', true);\n        } else {\n            $(window.combo[1]).prop('disabled', false);\n        }\n\n        $(window.combo[1]).change(this.change_in_perpage);\n        $(window.combo[0]).change(this.change_in_optimum);\n\n        toggleprintsettings(exportformat.val());\n        return true;\n    };\n\n    return instance;\n});\n"],"names":["define","$","log","Printpreviewer","prototype","change_in_perpage","e","preventDefault","stopPropagation","window","combo","val","prop","stdperpage","change_in_optimum","instance","initializer","washere","info","filterelement","groupelement","exportformat","selectall","select","toggleprintsettings","on","submit","Array","checked","change","this"],"mappings":";;;;;;;;AA2BAA,wDAAO,CAAC,SAAU,aAAa,SAASC,EAAGC,SAKnCC,eAAiB,aAGrBA,eAAeC,UAAUC,kBAAoB,SAASC,GAElDA,EAAEC,iBAEFD,EAAEE,kBAE6B,GAA5BP,EAAEQ,OAAOC,MAAM,IAAIC,OAElBV,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,WAAW,GACnCX,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,KAGpCH,OAAOI,WAAaZ,EAAEQ,OAAOC,MAAM,IAAIC,MACvCV,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,WAAW,GACnCX,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,KAI5CT,eAAeC,UAAUU,kBAAoB,SAASR,GAElDA,EAAEC,iBAEFD,EAAEE,kBAECP,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAEvBH,OAAOI,WAAaZ,EAAEQ,OAAOC,MAAM,IAAIC,MACvCV,EAAEQ,OAAOC,MAAM,IAAIC,IAAI,GACvBV,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,KAGpCX,EAAEQ,OAAOC,MAAM,IAAIC,IAAIF,OAAOI,YAC9BZ,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,SAIxCG,SAAW,IAAIZ,sBAEnBY,SAASC,YAAc,cAEfP,OAAOQ,eAAiB,EAC5BR,OAAOQ,QAAU,EACjBf,IAAIgB,KAAK,yCAA0C,uCAE/CC,cAAgBlB,EAAE,cAClBmB,aAAgBnB,EAAE,aAClBoB,aAAgBpB,EAAE,oBAClBqB,UAAYrB,EAAE,cACdsB,OAAStB,EAAE,gCAEXuB,oBAAsB,SAAUH,cACZ,GAAhBA,cACApB,EAAE,0BAA0BW,KAAK,YAAY,GAC7CX,EAAE,0BAA0BW,KAAK,YAAY,GAC7CX,EAAE,gBAAgBW,KAAK,YAAY,GACnCX,EAAE,uBAAuBW,KAAK,YAAY,GAC1CX,EAAE,mBAAmBW,KAAK,YAAY,KAEtCX,EAAE,0BAA0BW,KAAK,YAAY,GAC7CX,EAAE,0BAA0BW,KAAK,YAAY,GAC7CX,EAAE,gBAAgBW,KAAK,YAAY,GACnCX,EAAE,uBAAuBW,KAAK,YAAY,GAC1CX,EAAE,mBAAmBW,KAAK,YAAY,YAI1CO,eACAA,cAAcM,GAAG,UAAU,WACvBxB,EAAE,cAAcyB,YAIpBN,cACAA,aAAaK,GAAG,UAAU,WACtBxB,EAAE,cAAcyB,YAIpBL,cACAA,aAAaI,GAAG,UAAU,WACtBD,oBAAoBH,aAAaV,UAIzCW,UAAUV,KAAK,UAAW,WAC1BW,OAAOX,KAAK,UAAW,WAEvBH,OAAOC,MAAQ,IAAIiB,MACnBlB,OAAOC,MAAM,GAAK,kCAClBD,OAAOC,MAAM,GAAK,kCAElBD,OAAOI,WAAaZ,EAAEQ,OAAOC,MAAM,IAAIC,MAEpCV,EAAEQ,OAAOC,MAAM,IAAIkB,QAClB3B,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,GAEpCX,EAAEQ,OAAOC,MAAM,IAAIE,KAAK,YAAY,GAGxCX,EAAEQ,OAAOC,MAAM,IAAImB,OAAOC,KAAKzB,mBAC/BJ,EAAEQ,OAAOC,MAAM,IAAImB,OAAOC,KAAKhB,mBAE/BU,oBAAoBH,aAAaV,QAC1B,GAGJI"}